{% extends 'base.html' %}
{% load static %}

{% block title %} بنر ها {% endblock %}

{% block extra_static %}
<link rel="stylesheet" href="{% static 'core/css/banner.css' %}">
{% endblock %}

{% block content %}
<div class="container-banner">
    <!-- فرم افزودن بنر -->
    <div class="form-container card p-4 mb-4 shadow-sm">
        <h2 class="text-center mb-4 text-primary">افزودن بنر جدید</h2>
        <div class="alert alert-warning text-center mb-4" role="alert">
            <strong>نکته:</strong> پنج بنر اول در صفحه اصلی نمایش داده می‌شوند.
        </div>
        <form method="post" enctype="multipart/form-data" action="{% url 'core:add_banner' %}" class="banner-form">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit" class="btn btn-primary btn-block btn-lg">ثبت بنر</button>
        </form>
    </div>

    <!-- لیست بنرها -->
    <div class="table-container">
        <h1 class="text-center mb-4 text-secondary">لیست بنرها</h1>
        {% if banners %}
            <table class="table table-striped table-bordered table-hover">
                <thead class="table-dark">
                    <tr>
                        <th scope="col">ردیف</th>
                        <th scope="col">نام بنر</th>
                        <th scope="col">تصویر</th>
                        <th scope="col">عملیات</th>
                    </tr>
                </thead>
                <tbody>
                    {% for banner in banners %}
                        <tr class="{% if forloop.counter <= 5 %}table-success{% endif %}">
                            <td>{{ forloop.counter }}</td>
                            <td>{{ banner.title }}</td>
                            <td>
                                <img src="{{ banner.image.url }}" alt="{{ banner.title }}" class="banner-image" data-large-src="{{ banner.image.url }}">
                            </td>
                            <td>
                                <form method="post" action="{% url 'core:remove_banner' banner.id %}" class="delete-form">
                                    {% csrf_token %}
                                    <input type="hidden" name="_method" value="delete">
                                    <button type="submit" class="btn btn-danger btn-sm btn-delete">حذف</button>
                                </form>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <div class="alert alert-info text-center fade-in" role="alert">
                هیچ بنری یافت نشد. لطفاً بنر جدیدی اضافه کنید.
            </div>
        {% endif %}
    </div>
</div>

<!-- مدال پیش‌نمایش تصویر -->
<div class="image-preview-modal" id="imagePreviewModal">
    <span class="close-modal">&times;</span>
    <img class="modal-content" id="previewImage">
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'core/js/banner.js' %}"></script>
{% endblock %}
{% extends 'base.html' %}
{% load static %}

{% block title %}تماس با کلینیک دندانپزشکی دکتر بابایی و بهمدی | آدرس، شماره تماس و فرم ارتباط{% endblock %}

{% block meta_tags %}
    <meta name="description" content="راه‌های ارتباط با کلینیک دندانپزشکی دکتر بابایی و بهمدی؛ آدرس، شماره تماس، نقشه و فرم ارسال پیام برای مشاوره و رزرو نوبت.">
    <meta name="keywords" content="تماس با ما, کلینیک دندانپزشکی, شماره تماس, آدرس کلینیک, فرم تماس, دکتر بابایی, دکتر بهمدی">
    <meta property="og:title" content="تماس با کلینیک دندانپزشکی دکتر بابایی و بهمدی">
    <meta property="og:description" content="راه‌های ارتباط و فرم تماس با کلینیک دندانپزشکی دکتر بابایی و بهمدی.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://sbdental.ir/contact/">
    <meta property="og:image" content="https://sbdental.ir/static/img/site-logo.png">
{% endblock %}

{% block extra_static %}
    <!-- Neshan Leaflet SDK -->
    <link rel="stylesheet" href="https://static.neshan.org/sdk/leaflet/1.4.0/leaflet.css" />
    <link rel="stylesheet" href="{% static 'contact/css/contact.css' %}">
{% endblock %}

{% block content %}
<main class="container contact-container shadow-lg p-4 rounded bg-white my-5" aria-label="صفحه تماس">
    <!-- Message and Admin Button -->
    <section class="d-flex justify-content-between align-items-center mb-4">
        <span class="custom-message flex-grow-1 text-center">برای رزرو نوبت تماس بگیرید یا پیام دهید</span>
    
        {% if user.is_authenticated and user.is_superuser or user.is_doctor %}
            <a href="{% url 'contact:messages' %}" 
               class="btn btn-outline-primary shadow-sm transition-all hover-scale" 
               aria-label="مدیریت پیام‌ها">
                <i class="fas fa-envelope-open-text me-2" aria-hidden="true"></i>مدیریت پیام‌ها
            </a>
        {% endif %}
    </section>

    <div class="row g-4">
        <!-- Contact Form -->
        <section class="col-md-6" aria-label="فرم تماس">
            <article class="card h-100 border-0 shadow-sm animate-fade-in">
                <div class="card-body p-4">
                    <h2 class="mb-4 text-primary fw-bold">
                        <i class="fas fa-envelope me-2" aria-hidden="true"></i>ارسال پیام
                    </h2>
                    <form method="post" class="needs-validation" novalidate aria-live="polite">
                        {% csrf_token %}
                        {% for field in form %}
                            <div class="mb-3 form-group">
                                <label class="form-label fw-bold" for="{{ field.id_for_label }}">
                                    {{ field.label }}
                                    {% if field.field.required %}
                                        <span class="text-danger" aria-hidden="true">*</span>
                                    {% endif %}
                                </label>
                                {{ field }}
                                {% if field.help_text %}
                                    <small class="form-text text-muted">{{ field.help_text }}</small>
                                {% endif %}
                                {% if field.errors %}
                                    <div class="invalid-feedback d-block animate-shake" role="alert">
                                        {{ field.errors|first }}
                                    </div>
                                {% endif %}
                            </div>
                        {% endfor %}
                        <button type="submit" 
                                class="btn btn-primary btn-lg w-100 mt-3 transition-all hover-scale" 
                                aria-label="ارسال پیام">
                            <i class="fas fa-paper-plane me-2" aria-hidden="true"></i>ارسال پیام
                        </button>
                    </form>
                </div>
            </article>
        </section>

        <!-- Contact Info -->
        <section class="col-md-6" aria-label="اطلاعات تماس">
            <article class="card h-100 border-0 shadow-sm animate-fade-in">
                <div class="card-body p-4">
                    <h2 class="mb-4 text-primary fw-bold">
                        <i class="fas fa-map-marker-alt me-2" aria-hidden="true"></i>اطلاعات مطب
                    </h2>
                    {% if clinic %}
                        <div class="contact-details-clinic mb-4">
                            <p class="mb-2 d-flex align-items-center">
                                <strong class="text me-4">آدرس مطب:</strong>
                                <span class="text-muted" aria-label="آدرس مطب">{{ clinic.address }}</span>
                            </p>
                            <p class="mb-2 d-flex align-items-center">
                                <a href="tel:{{ clinic.phone }}" 
                                   class="text-decoration-none text hover-text-dark transition-all" 
                                   aria-label="تماس با شماره {{ clinic.phone }}">
                                    {{ clinic.phone }}
                                </a>
                            </p>
                            <p class="mb-2 d-flex align-items-center">
                                <a href="mailto:{{ clinic.email }}" 
                                   class="text-decoration-none text hover-text-dark transition-all" 
                                   aria-label="ارسال ایمیل به {{ clinic.email|default:'نامشخص' }}">
                                    {{ clinic.email|default:'نامشخص' }}
                                </a>
                            </p>
                        </div>
                    {% else %}
                        <p class="text-danger fw-bold animate-pulse" role="alert">
                            اطلاعات کلینیک ثبت نشده است.
                        </p>
                    {% endif %}

                    <h4 class="mt-4 text-secondary fw-bold">
                        <i class="fas fa-clock me-2" aria-hidden="true"></i>ساعات کاری
                    </h4>
                    <ul class="list-group shadow-sm rounded" aria-label="ساعات کاری هفتگی">
                        {% for wh in workinghours %}
                            <li class="list-group-item d-flex justify-content-between align-items-center transition-all hover-bg-light">
                                <span class="fw-bold text">
                                    {% if wh.day == 0 %}شنبه
                                    {% elif wh.day == 1 %}یک‌شنبه
                                    {% elif wh.day == 2 %}دوشنبه
                                    {% elif wh.day == 3 %}سه‌شنبه
                                    {% elif wh.day == 4 %}چهارشنبه
                                    {% elif wh.day == 5 %}پنج‌شنبه
                                    {% elif wh.day == 6 %}جمعه
                                    {% endif %}
                                </span>
                                <span class="text-muted">
                                    {% if wh.morning_start and wh.morning_end %}
                                         صبح {{ wh.morning_start }} تا {{ wh.morning_end }}
                                    {% else %}
                                        تعطیل
                                    {% endif %}
                                    <span class="mx-2" aria-hidden="true">|</span>
                                    {% if wh.evening_start and wh.evening_end %}
                                         عصر {{ wh.evening_start }} تا {{ wh.evening_end }}
                                    {% else %}
                                        تعطیل
                                    {% endif %}
                                </span>
                            </li>
                        {% empty %}
                            <li class="list-group-item text-danger fw-bold" role="alert">
                                هیچ ساعت کاری ثبت نشده است.
                            </li>
                        {% endfor %}
                    </ul>
                </div>
            </article>
        </section>
    </div>

    <!-- Map Section -->
    <section class="card mt-5 border-0 shadow-sm animate-fade-in" aria-label="نقشه موقعیت مطب">
        <div class="card-body p-4">
            <h2 class="section-title mb-4 text-primary fw-bold">
                <i class="fas fa-map-marker-alt me-2" aria-hidden="true"></i>موقعیت مکانی مطب
            </h2>
            <div id="map" class="rounded shadow-sm" style="height: 400px;" aria-label="نقشه نشان"></div>
        </div>
    </section>
</main>
{% endblock %}

{% block extra_js %}
    <script src="https://static.neshan.org/sdk/leaflet/1.4.0/leaflet.js"></script>
    <script src="{% static 'contact/js/contact.js' %}"></script>
{% endblock %}
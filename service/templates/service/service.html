{% extends 'base.html' %}
{% load static %}

{% block title %}خدمات دندانپزشکی | درمان، زیبایی و ایمپلنت در کلینیک دکتر بابایی و بهمدی{% endblock %}

{% block meta_tags %}
    <meta name="description" content="لیست خدمات تخصصی دندانپزشکی شامل درمان، زیبایی، ایمپلنت، ارتودنسی و مشاوره در کلینیک دکتر بابایی و بهمدی.">
    <meta name="keywords" content="خدمات دندانپزشکی, درمان دندان, زیبایی دندان, ایمپلنت, ارتودنسی, کلینیک دندانپزشکی, دکتر بابایی, دکتر بهمدی">
    <meta property="og:title" content="خدمات دندانپزشکی | کلینیک دکتر بابایی و بهمدی">
    <meta property="og:description" content="لیست خدمات تخصصی دندانپزشکی شامل درمان، زیبایی، ایمپلنت و ارتودنسی.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://sbdental.ir/services/">
    <meta property="og:image" content="https://sbdental.ir/static/img/site-logo.png">
{% endblock %}

{% block extra_static %}
<link rel="stylesheet" href="{% static 'service/css/service.css' %}">
{% endblock %}

{% block content %}
<main class="service-main-bg">
    <!-- Hero Section -->
    <section class="service-hero text-center py-5 mb-5">
        <div class="service-hero-icon mb-4">
            <span class="service-icon-wrapper">
                <i class="fas fa-tooth"></i>
            </span>
        </div>
        <h1 class="service-hero-title mb-3">خدمات دندانپزشکی مدرن</h1>
        <p class="service-hero-desc lead">در کلینیک ما، بهترین خدمات درمانی و زیبایی دندان با جدیدترین تکنولوژی و تیم حرفه‌ای ارائه می‌شود.</p>
        {% if user.is_authenticated and user.is_doctor or user.is_superuser %}
        <a href="{% url 'service:add_service' %}" class="service-add-btn">
            <i class="fas fa-plus-circle me-2"></i>
            افزودن خدمت جدید
        </a>
        {% endif %}
    </section>

    <!-- Services Grid -->
    <section class="service-grid-section">
        <div class="service-grid">
            {% for service in services %}
            <div class="service-card-fancy">
                <div class="service-card-img-wrap">
                    <img src="{{ service.image.url }}" alt="{{ service.title }}" loading="lazy" class="service-card-img">
                </div>
                <div class="service-card-body">
                    <h3 class="service-card-title">{{ service.title }}</h3>
                    <p class="service-card-desc">{{ service.description|truncatewords:25 }}</p>
                    {% if user.is_authenticated and user.is_doctor or user.is_superuser %}
                    <div class="service-card-actions">
                        <a href="{% url 'service:update_service' service.id %}" class="service-action-btn edit" title="ویرایش خدمت"><i class="fas fa-edit"></i></a>
                        <button class="service-action-btn delete" data-bs-toggle="modal" data-bs-target="#deleteModal-{{ service.id }}" title="حذف خدمت"><i class="fas fa-trash"></i></button>
                    </div>
                    {% endif %}
                </div>
            </div>
            {% empty %}
            <div class="service-empty-state">
                <img src="{% static 'images/empty-service.svg' %}" alt="خدمتی یافت نشد" class="service-empty-img mb-3">
                <h4 class="service-empty-title">در حال حاضر هیچ خدمتی ثبت نشده است</h4>
                <p class="service-empty-desc">برای افزودن خدمت جدید، روی دکمه بالا کلیک کنید یا بعداً دوباره بررسی نمایید.</p>
            </div>
            {% endfor %}
        </div>
    </section>

    <!-- Modals Section (Moved Outside the Cards) -->
    {% for service in services %}
        {% if user.is_authenticated and user.is_doctor or user.is_superuser %}
        <div class="modal fade" id="deleteModal-{{ service.id }}" tabindex="-1" aria-labelledby="deleteModalLabel-{{ service.id }}" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header bg-danger text-white">
                        <h5 class="modal-title" id="deleteModalLabel-{{ service.id }}">تأیید حذف</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="بستن"></button>
                    </div>
                    <form method="post" action="{% url 'service:remove_service' service.id %}">
                        {% csrf_token %}
                        <div class="modal-body text-center">
                            <p class="mb-3">آیا مطمئن هستید که می‌خواهید خدمت <strong>{{ service.title }}</strong> را حذف کنید؟</p>
                            <p class="text-muted small">این عمل قابل بازگشت نیست!</p>
                        </div>
                        <div class="modal-footer justify-content-center">
                            <button type="button" class="btn btn-secondary rounded-pill px-4" data-bs-dismiss="modal">انصراف</button>
                            <button type="submit" class="btn btn-danger rounded-pill px-4">حذف</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        {% endif %}
    {% endfor %}
</main>
{% endblock %}

{% block extra_js %}
<script src="{% static 'service/js/service.js' %}"></script>
{% endblock %}